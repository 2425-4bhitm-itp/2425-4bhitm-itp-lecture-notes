= 24/25 4bhitm - itp1 - Lecture Notes
Thomas StÃ¼tz
1.0.0, {docdate}: Lecture Notes for Courses at HTL Leonding
:icons: font
:experimental:
:sectnums:
ifndef::imagesdir[:imagesdir: images]
:toc:
ifdef::backend-html5[]
// https://fontawesome.com/v4.7.0/icons/
icon:file-text-o[link=https://github.com/2324-4bhif-wmc/2324-4bhif-wmc-lecture-notes/main/asciidocs/{docname}.adoc] â€ â€ â€
icon:github-square[link=https://github.com/2324-4bhif-wmc/2324-4bhif-wmc-lecture-notes] â€ â€ â€
icon:home[link=http://edufs.edu.htl-leonding.ac.at/~t.stuetz/hugo/2021/01/lecture-notes/]
endif::backend-html5[]

== 2024-09-26

=== Bezeichnungen in git-Repositories

image::git-repo-names.png[]

* Bezeichnungen sollten immer im kebab-Casing erstellt werden:
** Grund: beim erstellen von Docker-Images kann es zu Problemen kommen.
** statt "FerienPass" -> "ferien-pass"


=== Minimum Viable Product

* Eine User Story muss so klein sein, dass man sie in einem Sprint erledigen kann

* https://blog.crisp.se/2016/01/25/henrikkniberg/making-sense-of-mvp

* Alle 2 Wochen wird ein  neues MVP erstellt (Rapid Value Creation)

image::minimum-viable-product.png[]


== 2024-10-24

* https://dev.to/pavanbelagatti/learn-how-to-setup-a-cicd-pipeline-from-scratch-for-a-go-application-4m69

image::ci-cd-cd.png[]

=== gh-actions - Ein erster Workflow

* ist ein Mechanismus, mit dem shell-Befehle hinterlegt werden kÃ¶nnen, die anschlieÃŸend ausgefÃ¼hrt werden.

* https://docs.github.com/en/actions/writing-workflows/quickstart


* Was ist yaml?
** Vergleichbar mit JSON, nur andere Schreibweise


* Erstellen eines gh-Verzeichnisses
+
----
mkdir -p .github/workflows
----

* Erstellen einer https://docs.github.com/de/actions/writing-workflows/quickstart#creating-your-first-workflow[Workflow Datei^] `github-actions-demo.yaml`
+
[source,yaml]
----
name: GitHub Actions Demo
run-name: ${{ github.actor }} is testing out GitHub Actions ğŸš€
on: [push]
jobs:
  Explore-GitHub-Actions:
    runs-on: ubuntu-latest
    steps:
      - run: echo "ğŸ‰ The job was automatically triggered by a ${{ github.event_name }} event."
      - run: echo "ğŸ§ This job is now running on a ${{ runner.os }} server hosted by GitHub!"
      - run: echo "ğŸ” The name of your branch is ${{ github.ref }} and your repository is ${{ github.repository }}."
      - name: Check out repository code
        uses: actions/checkout@v4
      - run: echo "ğŸ’¡ The ${{ github.repository }} repository has been cloned to the runner."
      - run: echo "ğŸ–¥ï¸ The workflow is now ready to test your code on the runner."
      - name: List files in the repository
        run: |
          ls ${{ github.workspace }}
      - run: echo "ğŸ This job's status is ${{ job.status }}."
----
* Committen und pushen
+
image::gh-actions-first-run.png[]


=== Workflow zum kompilieren eines quarkus Projekts

* lÃ¶schen des bestehenden Workflow-Files oder deaktivieren mittels AnfÃ¼gen der Endung `disabled`

* Erstellen eines workflow-Files `actions.yaml`
+
image::gh-actions-folder.png[]
+
[source,yaml]
----
name: GitHub Actions Demo
run-name: ${{ github.actor }} is compiling a quarkus project ğŸš€
on: [push]
jobs:
  Explore-GitHub-Actions:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-java@v4 # <.>
        with:
          distribution: 'temurin'
          java-version: '21'
          cache: 'maven' # <.>
          cache-dependency-path: 'ci-cd/pom.xml' # optional
      - name: Build with Maven
        working-directory: ci-cd
        run: mvn -B package --file pom.xml
----

<.> Es ist sinnvoll am gh-Marketplace eine action zu suchen. Hier bildet die https://github.com/marketplace/actions/setup-java-jdk#caching-maven-dependencies[java-setup^]-action die Grundlage.

<.> Mit dieser Actions kÃ¶nnen die maven-dependencies zwischen den LÃ¤ufen gecached werden. Im Fehlerfall wird der Cache gelÃ¶scht.

image::gh-actions-2nd-run.png[]

== 2024-12-05

=== Rollenkonzept

image::rollenkonzept.png[]

=== Authorisierung und Authentifizierung

* Authorization: Wer bin ich? -> 401 Unauthorized
* Authentication: Was darf ich? -> 403 Forbidden


=== Keycloak

* User

== 2024-12-12

image::keycloak-architektur.png[]

* https://www.urlencoder.org/[URL Encoder/Decoder]


== 2025-02-27 Security

----
git clone git@github.com:caberger/keycloak.git

cd compose
docker compose up --build

# LÃ¶schen der images und volumes
docker image ls -q | xargs docker image rm
docker volume ls -q | xargs docker volume rm
----

== 2025-03-06 OIDC

image::reverse-engineering.png[]

image::reverse-engineering.png[]

image::authentication-authorization.png[]

* FÃ¼r die Umsetzung verwenden wir Keycloak

* RBAC: Role Based Access Control

.Quelle: https://abdulsamet-ileri.medium.com/introduction-to-keycloak-227c3902754a
image::keycloak-standard-flow.png[Introduction to Keycloak^]

* Wir verwenden hier den OIDC Standard

== 2025-03-13

=== RBAC

* Role Based Access Control

* Die Zugriffsrechte auf eine APP (API) werden oft Ã¼ber die API selbst definiert, dh bestimmte Endpoints sind nur mit bestimmten Rollen zugÃ¤nglich

* Bei RBAC sind dazu Annotationen im Code notwendig.

* Eine Alternative dazu sind sogenannte Policies (Politiken), die in Keycloak definiert werden.

** Keycloak ist ein IAM ein *Identity and Access Management System*.


* Was ist eine Rolle?
** Eine Sammlung von Rechten (Permissions)

* Wenn ein Recht fÃ¼r den Zugriff auf einen Endpoint nicht vorhanden ist, wird ein 403 Forbidden zurÃ¼ckgegeben.

* Voraussetzung fÃ¼r die ÃœberprÃ¼fung auf ein vorhandenes Recht ist, dass der Benutzer authentifiziert ist und ein gÃ¼ltiges Token besitzt.
** Wer bin ich? (Authentifizierung)
** Was darf ich? (Autorisierung) - welche Rechte habe ich?

* Was ist eine Resource?
** Ein REST-Endpoint, auf den zugegriffen werden kann.

* Annotationen in Quarkus:
** @PermitAll: Jeder darf auf den Endpoint zugreifen


* application.properties
** quarkus.oidc.auth-server-url damit wird die ausstellende Stelle des Tokens definiert

* FÃ¼r Web-Frontends

** https://www.keycloak.org/securing-apps/javascript-adapter


== 2025-03-27

=== Keycloak bei Angular-Frontend

==== Richtige (lokale) Installation von Angular

* Man mÃ¶chte sich nicht darauf verlassen, was ein anderer auf der Maschine installiert hat.

* Angular wird lokal installiert

----
npm init -y
npm install @angular/cli
----

* Die globale Installation verschmutzt den Pfad und legt ng in einer bestimmten Version in den globalen Path.

* npx ... Node Package Exceutor

----
npx ng new ng-demo
----


----
npm outdated
find . -type f -print | wc -l

----


==== Exkurs: DI in Angular

* Promise: Versprechen, dass nach Fertigstellung Daten "geliefert" werden.

** https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise[MDN Promise^]

** https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/then[Promise.prototype.then()^]
+
[source,typescript]
----
const promise1 = new Promise((resolve, reject) => {
  //resolve("Success!");
  reject();
});

promise1.then((value) => {
  console.log(value);
  // Expected output: "Success!"
},() => {console.log('Das ist schief gegangen')}
             );
----

* async-await

** https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function


* fetch-api


==== Ãœbung

* Erstellen einer Angular-App, bei der man sich an einem keycloak server authentifiziert und dann erhÃ¤lt man einen chuck-norris witz.



















