= 24/25 4bhitm - itp1 - Lecture Notes
Thomas St√ºtz
1.0.0, {docdate}: Lecture Notes for Courses at HTL Leonding
:icons: font
:experimental:
:sectnums:
ifndef::imagesdir[:imagesdir: images]
:toc:
ifdef::backend-html5[]
// https://fontawesome.com/v4.7.0/icons/
icon:file-text-o[link=https://github.com/2324-4bhif-wmc/2324-4bhif-wmc-lecture-notes/main/asciidocs/{docname}.adoc] ‚Äè ‚Äè ‚Äé
icon:github-square[link=https://github.com/2324-4bhif-wmc/2324-4bhif-wmc-lecture-notes] ‚Äè ‚Äè ‚Äé
icon:home[link=http://edufs.edu.htl-leonding.ac.at/~t.stuetz/hugo/2021/01/lecture-notes/]
endif::backend-html5[]

== 2024-09-26

=== Bezeichnungen in git-Repositories

image::git-repo-names.png[]

* Bezeichnungen sollten immer im kebab-Casing erstellt werden:
** Grund: beim erstellen von Docker-Images kann es zu Problemen kommen.
** statt "FerienPass" -> "ferien-pass"


=== Minimum Viable Product

* Eine User Story muss so klein sein, dass man sie in einem Sprint erledigen kann

* https://blog.crisp.se/2016/01/25/henrikkniberg/making-sense-of-mvp

* Alle 2 Wochen wird ein  neues MVP erstellt (Rapid Value Creation)

image::minimum-viable-product.png[]


== 2024-10-24

* https://dev.to/pavanbelagatti/learn-how-to-setup-a-cicd-pipeline-from-scratch-for-a-go-application-4m69

image::ci-cd-cd.png[]

=== gh-actions - Ein erster Workflow

* ist ein Mechanismus, mit dem shell-Befehle hinterlegt werden k√∂nnen, die anschlie√üend ausgef√ºhrt werden.

* https://docs.github.com/en/actions/writing-workflows/quickstart


* Was ist yaml?
** Vergleichbar mit JSON, nur andere Schreibweise


* Erstellen eines gh-Verzeichnisses
+
----
mkdir -p .github/workflows
----

* Erstellen einer https://docs.github.com/de/actions/writing-workflows/quickstart#creating-your-first-workflow[Workflow Datei^] `github-actions-demo.yaml`
+
[source,yaml]
----
name: GitHub Actions Demo
run-name: ${{ github.actor }} is testing out GitHub Actions üöÄ
on: [push]
jobs:
  Explore-GitHub-Actions:
    runs-on: ubuntu-latest
    steps:
      - run: echo "üéâ The job was automatically triggered by a ${{ github.event_name }} event."
      - run: echo "üêß This job is now running on a ${{ runner.os }} server hosted by GitHub!"
      - run: echo "üîé The name of your branch is ${{ github.ref }} and your repository is ${{ github.repository }}."
      - name: Check out repository code
        uses: actions/checkout@v4
      - run: echo "üí° The ${{ github.repository }} repository has been cloned to the runner."
      - run: echo "üñ•Ô∏è The workflow is now ready to test your code on the runner."
      - name: List files in the repository
        run: |
          ls ${{ github.workspace }}
      - run: echo "üçè This job's status is ${{ job.status }}."
----
* Committen und pushen
+
image::gh-actions-first-run.png[]


=== Workflow zum kompilieren eines quarkus Projekts

* l√∂schen des bestehenden Workflow-Files oder deaktivieren mittels Anf√ºgen der Endung `disabled`

* Erstellen eines workflow-Files `actions.yaml`
+
image::gh-actions-folder.png[]
+
[source,yaml]
----
name: GitHub Actions Demo
run-name: ${{ github.actor }} is compiling a quarkus project üöÄ
on: [push]
jobs:
  Explore-GitHub-Actions:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-java@v4 # <.>
        with:
          distribution: 'temurin'
          java-version: '21'
          cache: 'maven' # <.>
          cache-dependency-path: 'ci-cd/pom.xml' # optional
      - name: Build with Maven
        working-directory: ci-cd
        run: mvn -B package --file pom.xml
----

<.> Es ist sinnvoll am gh-Marketplace eine action zu suchen. Hier bildet die https://github.com/marketplace/actions/setup-java-jdk#caching-maven-dependencies[java-setup^]-action die Grundlage.

<.> Mit dieser Actions k√∂nnen die maven-dependencies zwischen den L√§ufen gecached werden. Im Fehlerfall wird der Cache gel√∂scht.

image::gh-actions-2nd-run.png[]

== 2024-12-05

=== Rollenkonzept

image::rollenkonzept.png[]

=== Authorisierung und Authentifizierung

* Authorization: Wer bin ich? -> 401 Unauthorized
* Authentication: Was darf ich? -> 403 Forbidden


=== Keycloak

* User

== 2024-12-12

image::keycloak-architektur.png[]

* https://www.urlencoder.org/[URL Encoder/Decoder]


== 2025-02-27 Security

----
git clone git@github.com:caberger/keycloak.git

cd compose
docker compose up --build

# L√∂schen der images und volumes
docker image ls -q | xargs docker image rm
docker volume ls -q | xargs docker volume rm
----

== 2025-03-06 OIDC

image::reverse-engineering.png[]

image::reverse-engineering.png[]

image::authentication-authorization.png[]

* F√ºr die Umsetzung verwenden wir Keycloak

* RBAC: Role Based Access Control

.Quelle: https://abdulsamet-ileri.medium.com/introduction-to-keycloak-227c3902754a
image::keycloak-standard-flow.png[Introduction to Keycloak^]

* Wir verwenden hier den OIDC Standard

== 2025-03-13

=== RBAC

* Role Based Access Control

* Die Zugriffsrechte auf eine APP (API) werden oft √ºber die API selbst definiert, dh bestimmte Endpoints sind nur mit bestimmten Rollen zug√§nglich

* Bei RBAC sind dazu Annotationen im Code notwendig.

* Eine Alternative dazu sind sogenannte Policies (Politiken), die in Keycloak definiert werden.

** Keycloak ist ein IAM ein *Identity and Access Management System*.


* Was ist eine Rolle?
** Eine Sammlung von Rechten (Permissions)

* Wenn ein Recht f√ºr den Zugriff auf einen Endpoint nicht vorhanden ist, wird ein 403 Forbidden zur√ºckgegeben.

* Voraussetzung f√ºr die √úberpr√ºfung auf ein vorhandenes Recht ist, dass der Benutzer authentifiziert ist und ein g√ºltiges Token besitzt.
** Wer bin ich? (Authentifizierung)
** Was darf ich? (Autorisierung) - welche Rechte habe ich?

* Was ist eine Resource?
** Ein REST-Endpoint, auf den zugegriffen werden kann.

* Annotationen in Quarkus:
** @PermitAll: Jeder darf auf den Endpoint zugreifen


* application.properties
** quarkus.oidc.auth-server-url damit wird die ausstellende Stelle des Tokens definiert

* F√ºr Web-Frontends

** https://www.keycloak.org/securing-apps/javascript-adapter


== 2025-03-27

=== Keycloak bei Angular-Frontend

==== Richtige (lokale) Installation von Angular

* Man m√∂chte sich nicht darauf verlassen, was ein anderer auf der Maschine installiert hat.

* Angular wird lokal installiert

----
npm init -y
npm install @angular/cli
----

* Die globale Installation verschmutzt den Pfad und legt ng in einer bestimmten Version in den globalen Path.

* npx ... Node Package Exceutor

----
npx ng new ng-demo
----


----
npm outdated
find . -type f -print | wc -l

----


==== Exkurs: DI in Angular

* Promise: Versprechen, dass nach Fertigstellung Daten "geliefert" werden.

** https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise[MDN Promise^]

** https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/then[Promise.prototype.then()^]
+
[source,typescript]
----
const promise1 = new Promise((resolve, reject) => {
  //resolve("Success!");
  reject();
});

promise1.then((value) => {
  console.log(value);
  // Expected output: "Success!"
},() => {console.log('Das ist schief gegangen')}
             );
----

* async-await

** https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function


* fetch-api


==== √úbung

* Erstellen einer Angular-App, bei der man sich an einem keycloak server authentifiziert und dann erh√§lt man einen chuck-norris witz.


== 2025-04-10

=== Frontend vs Backend

image::frontend-vs-backend.png[]



=== Einrichten eines nginx-Servers

image::reverse-proxy-vm.png[]

.bash_history
----
apt-get update && apt-get dist-upgrade
apt autoremove
df -h
docker container ls -a
docker container prune
docker image ls
docker container prune
docker image prune
docker image ls -q | xargs docker image rm
docker image ls
docker volume ls
docker volume prune
docker volume prune -f
docker volume prune -a
docker volume ls
docker builder prune -f
docker network ls
docker network rm leo-iot_default
docker network rm leo-iot_quarkus
systemctl status nginx
apt install nginx
systemctl enable nginx
systemctl restart nginx
netstat -ant
apt install net-tools
netstat -ant
netstat -antp
ifconfig
cd /etc/nginx/conf.d/
cd ..
ll
cat nginx.conf
cd sites-enabled/
cat default
cd /var/www/html/
ll
nano index.nginx-debian.html
----



== 2025-04-24

=== Erstellen einer docker-compose.yaml f√ºr Quarkus-Backend

* Der Code ist https://github.com/2425-4bhitm-sew/2425-4bhitm-sew-lecture-notes[hier^] zu finden.
** SubDir: labs/docker/vehicle/

* Dockern einer postgres-db
** https://www.docker.com/blog/how-to-use-the-postgres-docker-official-image/[How to Use the Postgres Docker Official Image^]

IMPORTANT: In obigem Artikel sieht man sch√∂n, wie man mit healthcheck die Startreihenfolge der Container (Services) steuern kann.



== 2025-04-08

++++
<iframe width="560" height="315" src="https://www.youtube.com/embed/xWWXD_NKpHs?si=k5yalhUTDohinzaD" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
++++

++++
<iframe width="560" height="315" src="https://www.youtube.com/embed/ftnH9ZX1Atk?si=7AgAcVuPm0qYBYDP" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
++++

++++
<iframe width="560" height="315" src="https://www.youtube.com/embed/xo5V9g9joFs?si=4vj26WGDEHsfvYXb" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
++++

=== Eclipse Data Store

image::eclipse-data-store.png[]

* https://eclipsestore.io/[^]


=== Fortsetzung gh-actions

* https://github.com/2425-4bhitm-itp/vehicle-gh-actions-demo[^]

















